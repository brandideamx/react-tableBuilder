{"ast":null,"code":"import _slicedToArray from \"/Users/jc/Documents/rancho/rancho-client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/jc/Documents/rancho/rancho-client/src/components/TableBuilder.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Table, Button, Form, Pagination, Spinner } from 'react-bootstrap';\nimport moment from 'moment';\nimport 'moment/locale/es';\nimport MyModal from './MyModal';\nimport AddEntryForm from './AddEntryForm';\nimport EditEntryForm from './EditEntryForm';\nimport Swal from 'sweetalert2';\nimport API from '../utils/API';\nimport { getAllEntries } from '../actions'; // const WebSocketUrl = 'ws://localhost:8000';\n\nconst WebSocketUrl = 'wss://rancho-customs-brokers.herokuapp.com';\n\nconst TableBuilder = props => {\n  const _useSelector = useSelector(state => ({\n    entries: state.entries,\n    user: state.user\n  })),\n        entries = _useSelector.entries,\n        user = _useSelector.user;\n\n  const dispatch = useDispatch();\n\n  const _useState = useState(1),\n        _useState2 = _slicedToArray(_useState, 2),\n        currentPage = _useState2[0],\n        setCurrentPage = _useState2[1];\n\n  const _useState3 = useState(10),\n        _useState4 = _slicedToArray(_useState3, 2),\n        resultsPerPage = _useState4[0],\n        setResultsPerPage = _useState4[1];\n\n  const _useState5 = useState(0),\n        _useState6 = _slicedToArray(_useState5, 2),\n        offset = _useState6[0],\n        setOffset = _useState6[1];\n\n  const _useState7 = useState(0),\n        _useState8 = _slicedToArray(_useState7, 2),\n        totalRows = _useState8[0],\n        setTotalRows = _useState8[1];\n\n  const headers = {\n    'Authorization': user.token\n  };\n\n  const _useState9 = useState(entries),\n        _useState10 = _slicedToArray(_useState9, 2),\n        rows = _useState10[0],\n        setRows = _useState10[1];\n\n  const _useState11 = useState(false),\n        _useState12 = _slicedToArray(_useState11, 2),\n        modalShow = _useState12[0],\n        setModalShow = _useState12[1];\n\n  const _useState13 = useState({\n    heading: '',\n    body: ''\n  }),\n        _useState14 = _slicedToArray(_useState13, 2),\n        modalData = _useState14[0],\n        setModalData = _useState14[1];\n\n  const tableHeaders = ['# Entrada', 'Distribuidor', 'Productos', 'Fecha'];\n\n  const _useState15 = useState(true),\n        _useState16 = _slicedToArray(_useState15, 2),\n        loading = _useState16[0],\n        setLoading = _useState16[1];\n\n  const ws = new WebSocket(WebSocketUrl);\n\n  const totalRecords = async () => {\n    const results = await API.authGetRequest('/entries/count', headers);\n    setTotalRows(results.rows);\n  };\n\n  async function getData() {\n    const res = await API.authGetRequest('/entries', headers);\n    dispatch(getAllEntries(res));\n    setRows(res);\n    setLoading(false);\n  }\n\n  useEffect(() => {\n    getData();\n    totalRecords();\n  }, [rows]);\n  useEffect(() => {\n    // WS action\n    ws.onopen = () => {\n      // on connecting, do nothing but log it to the console\n      console.log('connected');\n    };\n\n    ws.onmessage = evt => {\n      // on receiving a message, add it to the list of messages\n      // const message = JSON.parse(evt.data)\n      // addMessage(message)\n      getData();\n    };\n\n    ws.onclose = () => {\n      console.log('disconnected'); // automatically try to reconnect on connection loss\n      // setState({\n      //   ws: new WebSocket(URL),\n      // })\n    };\n  }, []);\n\n  const handleSearch = async event => {\n    const query = event.target.value;\n    const results = await API.authPostRequest('/entries/search', {\n      query: query\n    }, headers);\n    setRows(results);\n  };\n\n  const afterSubmit = action => {\n    setModalShow(false);\n    ws.send(action); // getData();\n  };\n\n  const addEntryModal = () => {\n    setModalData({\n      heading: 'Agregar entrada',\n      body: React.createElement(AddEntryForm, {\n        user: user,\n        afterSubmit: () => afterSubmit('add'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      })\n    });\n    setModalShow(true);\n  };\n\n  const handleEdit = entry => {\n    setModalData({\n      heading: 'Editar entrada',\n      body: React.createElement(EditEntryForm, {\n        user: user,\n        entry: entry,\n        afterSubmit: () => afterSubmit('edit'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      })\n    });\n    setModalShow(true);\n  };\n\n  const handleDelete = id => {\n    Swal.fire({\n      title: '¿Estas seguro?',\n      text: \"¡No podras revertir esta acción!\",\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#d33',\n      confirmButtonText: 'Si',\n      cancelButtonText: 'Cancelar'\n    }).then(async result => {\n      // if selects yes\n      if (result.value) {\n        const res = await API.authGetRequest(`/entries/${id}/delete`, headers);\n\n        if (!res.success) {\n          Swal.fire({\n            title: 'Error!',\n            text: res.message,\n            icon: 'error'\n          });\n        } else if (res.success) {\n          Swal.fire({\n            title: '¡Éxito!',\n            text: res.message,\n            icon: 'success'\n          });\n          getData(); // afterSubmit('delete');\n        }\n      }\n    });\n  };\n\n  const handleCurrentPage = props => {\n    console.log(props);\n  };\n\n  const handleResultsPerPage = props => {\n    console.log(props);\n  };\n\n  const handleOffset = props => {\n    console.log(props);\n  };\n\n  return React.createElement(React.Fragment, null, loading ? React.createElement(\"div\", {\n    className: \"d-flex flex-center flex-align-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, React.createElement(Spinner, {\n    animation: \"border\",\n    variant: \"primary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  })) : React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    className: \"mb-3 d-flex flex-end flex-align-baseline\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }, props.showSearchBar ? React.createElement(SearchBar, {\n    onChange: handleSearch,\n    placeholder: props.searchBarHint,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }) : null, props.actions ? React.createElement(React.Fragment, null, React.createElement(MyModal, {\n    show: modalShow,\n    onHide: () => setModalShow(false),\n    heading: modalData.heading,\n    body: modalData.body,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }), React.createElement(Button, {\n    title: \"Agregar nueva\",\n    variant: \"success\",\n    size: \"md\",\n    className: \"mx-1\",\n    onClick: addEntryModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fa fa-plus\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }))) : null), React.createElement(Table, {\n    striped: true,\n    bordered: true,\n    hover: true,\n    size: \"sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, React.createElement(TableHeaders, {\n    headers: tableHeaders,\n    actions: props.actions,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }), React.createElement(TableBody, {\n    actions: props.actions,\n    data: rows,\n    edit: handleEdit,\n    delete: handleDelete,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213\n    },\n    __self: this\n  })), React.createElement(TableFooter, {\n    entries: totalRows,\n    currentPage: currentPage,\n    resultsPerPage: resultsPerPage,\n    offset: offset,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220\n    },\n    __self: this\n  })));\n};\n\nconst TableFooter = props => {\n  return React.createElement(\"div\", {\n    className: \"table-footer d-flex flex-space-between flex-align-baseline\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }, React.createElement(RowsCount, {\n    entries: props.entries,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235\n    },\n    __self: this\n  }), React.createElement(Paginator, {\n    entries: props.entries,\n    currentPage: props.currentPage,\n    resultsPerPage: props.resultsPerPage,\n    offset: props.offset,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236\n    },\n    __self: this\n  }));\n};\n\nconst RowsCount = props => {\n  const records = props.entries;\n  return React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249\n    },\n    __self: this\n  }, records, \" resultados.\");\n};\n\nconst Paginator = props => {\n  const entries = props.entries,\n        resultsPerPage = props.resultsPerPage,\n        offset = props.offset,\n        currentPage = props.currentPage;\n  let totalPages = Math.ceil(entries / resultsPerPage);\n  let i = 1;\n  let pages = [];\n\n  while (i <= totalPages) {\n    pages.push(i);\n    i++;\n  }\n\n  const Items = pages.map((page, index) => React.createElement(React.Fragment, null, currentPage === page ? React.createElement(Pagination.Item, {\n    key: index,\n    active: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267\n    },\n    __self: this\n  }, page) : React.createElement(Pagination.Item, {\n    key: index,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269\n    },\n    __self: this\n  }, page)));\n  return React.createElement(Pagination, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275\n    },\n    __self: this\n  }, Items);\n};\n\nconst SearchBar = props => {\n  return React.createElement(Form.Control, {\n    type: \"text\",\n    name: \"search\",\n    onChange: props.onChange,\n    placeholder: props.placeholder,\n    className: \"mx-1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288\n    },\n    __self: this\n  });\n};\n\nconst TableHeaders = ({\n  headers,\n  actions = false\n}) => {\n  return React.createElement(\"thead\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300\n    },\n    __self: this\n  }, React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301\n    },\n    __self: this\n  }, headers.map((header, index) => React.createElement(\"th\", {\n    key: index,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302\n    },\n    __self: this\n  }, header)), actions ? React.createElement(\"th\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304\n    },\n    __self: this\n  }, \"Acciones\") : null));\n};\n\nconst TableBody = props => {\n  const data = props.data;\n  return React.createElement(\"tbody\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315\n    },\n    __self: this\n  }, data.length === 0 ? React.createElement(EmptyRow, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317\n    },\n    __self: this\n  }) : React.createElement(React.Fragment, null, data.map(entry => React.createElement(Row, {\n    key: entry.id,\n    entry: entry,\n    actions: props.actions,\n    edit: props.edit,\n    delete: props.delete,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321\n    },\n    __self: this\n  }))));\n};\n\nconst EmptyRow = () => {\n  return React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 337\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    colSpan: \"5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338\n    },\n    __self: this\n  }, \"No hay resultados\"));\n};\n\nconst Row = props => {\n  const entry = props.entry;\n  const properties = entry.properties;\n  const customer = properties.customer;\n  const products = properties.invoicedetails;\n  const formatted = formatInvoices(products);\n  const invoices = formatted.map(product => React.createElement(\"div\", {\n    key: product.id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 351\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"text-bold\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352\n    },\n    __self: this\n  }, \"Producto:\"), \" \", product.description), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"text-bold\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353\n    },\n    __self: this\n  }, \"Agricultor:\"), \" \", product.grower)));\n\n  const handleEdit = () => {\n    props.edit(entry);\n  };\n\n  const handleDelete = () => {\n    props.delete(entry.id);\n  };\n\n  return React.createElement(\"tr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365\n    },\n    __self: this\n  }, React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366\n    },\n    __self: this\n  }, entry.id), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367\n    },\n    __self: this\n  }, customer), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368\n    },\n    __self: this\n  }, invoices), React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371\n    },\n    __self: this\n  }, moment(entry.created_at).format('MMMM D YYYY, h:mm a')), props.actions ? React.createElement(\"td\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373\n    },\n    __self: this\n  }, React.createElement(Button, {\n    title: \"Editar\",\n    size: \"sm\",\n    variant: \"info\",\n    className: \"mr-2\",\n    onClick: handleEdit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fa fa-pencil\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 380\n    },\n    __self: this\n  })), React.createElement(Button, {\n    title: \"Eliminar\",\n    size: \"sm\",\n    variant: \"danger\",\n    onClick: handleDelete,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 382\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"fa fa-trash\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 387\n    },\n    __self: this\n  }))) : null);\n};\n\nconst formatInvoices = invoices => {\n  if (invoices === undefined) return [];\n  let keys = Object.keys(invoices);\n  let formatted = [];\n  keys.map(item => {\n    formatted.push(invoices[item]);\n    return null;\n  });\n  return formatted;\n};\n\nexport default TableBuilder;","map":{"version":3,"sources":["/Users/jc/Documents/rancho/rancho-client/src/components/TableBuilder.jsx"],"names":["React","useState","useEffect","useSelector","useDispatch","Table","Button","Form","Pagination","Spinner","moment","MyModal","AddEntryForm","EditEntryForm","Swal","API","getAllEntries","WebSocketUrl","TableBuilder","props","state","entries","user","dispatch","currentPage","setCurrentPage","resultsPerPage","setResultsPerPage","offset","setOffset","totalRows","setTotalRows","headers","token","rows","setRows","modalShow","setModalShow","heading","body","modalData","setModalData","tableHeaders","loading","setLoading","ws","WebSocket","totalRecords","results","authGetRequest","getData","res","onopen","console","log","onmessage","evt","onclose","handleSearch","event","query","target","value","authPostRequest","afterSubmit","action","send","addEntryModal","handleEdit","entry","handleDelete","id","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","then","result","success","message","handleCurrentPage","handleResultsPerPage","handleOffset","showSearchBar","searchBarHint","actions","TableFooter","RowsCount","records","Paginator","totalPages","Math","ceil","i","pages","push","Items","map","page","index","SearchBar","onChange","placeholder","TableHeaders","header","TableBody","data","length","edit","delete","EmptyRow","Row","properties","customer","products","invoicedetails","formatted","formatInvoices","invoices","product","description","grower","created_at","format","undefined","keys","Object","item"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Table, Button, Form, Pagination, Spinner } from 'react-bootstrap';\nimport moment from 'moment';\nimport 'moment/locale/es';\nimport MyModal from './MyModal';\nimport AddEntryForm from './AddEntryForm';\nimport EditEntryForm from './EditEntryForm';\nimport Swal from 'sweetalert2';\nimport API from '../utils/API';\nimport { getAllEntries } from '../actions';\n\n// const WebSocketUrl = 'ws://localhost:8000';\nconst WebSocketUrl = 'wss://rancho-customs-brokers.herokuapp.com';\n\n\nconst TableBuilder = props => {\n  const { entries, user } = useSelector(state => ({\n    entries: state.entries,\n    user: state.user,\n  }));\n  const dispatch = useDispatch();\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [resultsPerPage, setResultsPerPage] = useState(10);\n  const [offset, setOffset] = useState(0);\n  const [totalRows, setTotalRows] = useState(0);\n  \n  const headers = {\n    'Authorization': user.token\n  }\n\n  const [rows, setRows] = useState(entries);\n\n  const [modalShow, setModalShow] = useState(false);\n  const [modalData, setModalData] = useState({\n    heading: '',\n    body: ''\n  });\n  const tableHeaders = [\n    '# Entrada',\n    'Distribuidor',\n    'Productos',\n    'Fecha'\n  ];\n\n  const [loading, setLoading] = useState(true);\n\n  const ws = new WebSocket(WebSocketUrl);\n  \n  const totalRecords = async () => {\n    const results = await API.authGetRequest('/entries/count', headers);\n    setTotalRows(results.rows);\n  }\n\n  async function getData() {\n    const res = await API.authGetRequest('/entries', headers);\n    dispatch(getAllEntries(res));\n    setRows(res);\n    setLoading(false);\n  }\n\n  useEffect(() => {\n    getData();\n    totalRecords();\n  }, [rows]);\n\n  useEffect(() => {\n    // WS action\n    ws.onopen = () => {\n      // on connecting, do nothing but log it to the console\n      console.log('connected')\n    }\n\n    ws.onmessage = evt => {\n      // on receiving a message, add it to the list of messages\n      // const message = JSON.parse(evt.data)\n      // addMessage(message)\n      getData();\n    }\n\n    ws.onclose = () => {\n      console.log('disconnected')\n      // automatically try to reconnect on connection loss\n      // setState({\n      //   ws: new WebSocket(URL),\n      // })\n    }\n  }, []);\n\n  const handleSearch = async event => {\n    const query =event.target.value;\n    const results = await API.authPostRequest('/entries/search', { query: query }, headers);\n    setRows(results);\n  }\n\n  const afterSubmit = (action) => {\n    setModalShow(false);\n    ws.send(action);\n    // getData();\n  }\n\n  const addEntryModal = () => {\n    setModalData({\n      heading: 'Agregar entrada',\n      body: <AddEntryForm\n              user={user}\n              afterSubmit={() => afterSubmit('add')}\n            />\n    });\n    setModalShow(true);\n  }\n\n  const handleEdit = (entry) => {\n    setModalData({\n      heading: 'Editar entrada',\n      body: <EditEntryForm \n              user={user}\n              entry={entry}\n              afterSubmit={() => afterSubmit('edit')}\n            />\n    });\n    setModalShow(true);\n  }\n\n  const handleDelete = (id) => {\n    Swal.fire({\n      title: '¿Estas seguro?',\n      text: \"¡No podras revertir esta acción!\",\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#d33',\n      confirmButtonText: 'Si',\n      cancelButtonText: 'Cancelar',\n    }).then(async (result) => {\n      // if selects yes\n      if (result.value) {     \n        const res = await API.authGetRequest(`/entries/${id}/delete`, headers);\n        if(!res.success) {\n          Swal.fire({\n            title: 'Error!',\n            text: res.message,\n            icon: 'error',\n          });\n        }\n        else if(res.success) {\n          Swal.fire({\n            title: '¡Éxito!',\n            text: res.message,\n            icon: 'success',\n          });\n          getData();\n          // afterSubmit('delete');\n        }\n      }\n    })\n  }\n\n  const handleCurrentPage = props => {\n    console.log(props);\n  }\n\n  const handleResultsPerPage = props => {\n    console.log(props);\n  }\n  const handleOffset = props => {\n    console.log(props);\n  }\n\n  return (\n    <>\n    { loading ?\n      <div className=\"d-flex flex-center flex-align-center\">\n        <Spinner animation=\"border\" variant=\"primary\" />\n      </div>\n      :\n    <>\n      <div className=\"mb-3 d-flex flex-end flex-align-baseline\">\n        { props.showSearchBar ?\n          <SearchBar \n            onChange={handleSearch}\n            placeholder={props.searchBarHint}\n          />\n          : null\n        }\n        { props.actions ?\n        <>\n          <MyModal\n            show={modalShow}\n            onHide={() => setModalShow(false)}\n            heading={modalData.heading}\n            body={modalData.body}\n          />\n          <Button \n            title=\"Agregar nueva\"\n            variant=\"success\"\n            size=\"md\" \n            className=\"mx-1\" \n            onClick={addEntryModal}\n          >\n            <i className=\"fa fa-plus\"></i>\n          </Button>\n        </>\n          : null\n        }\n      </div>\n      <Table striped bordered hover size=\"sm\">\n        <TableHeaders \n          headers={tableHeaders}\n          actions={props.actions}\n        />\n        <TableBody\n          actions={props.actions}\n          data={rows}\n          edit={handleEdit}\n          delete={handleDelete}\n        />\n      </Table>\n      <TableFooter\n        entries={totalRows}\n        currentPage={currentPage}\n        resultsPerPage={resultsPerPage}\n        offset={offset}\n      />\n    </>\n    }\n    </>\n  );\n}\n\nconst TableFooter = (props) => {\n  return (\n    <div className=\"table-footer d-flex flex-space-between flex-align-baseline\">\n      <RowsCount entries={props.entries} />\n      <Paginator \n        entries={props.entries}\n        currentPage={props.currentPage}\n        resultsPerPage={props.resultsPerPage}\n        offset={props.offset}\n      />\n    </div>\n  )\n}\n\nconst RowsCount = (props) => {\n  const records = props.entries;\n  return (\n    <span>{records} resultados.</span>\n  )\n}\n\nconst Paginator = props => {\n  const { entries, resultsPerPage, offset, currentPage } = props;\n  let totalPages = Math.ceil(entries / resultsPerPage);\n\n  let i = 1;\n  let pages = [];\n  while(i <= totalPages) {\n    pages.push(i);\n    i++;\n  }\n\n  const Items = pages.map((page, index) => (\n    <>\n      { currentPage === page ?\n        <Pagination.Item key={index} active>{page}</Pagination.Item>\n        :\n        <Pagination.Item key={index}>{page}</Pagination.Item>\n      }\n    </>\n  )); \n\n  return(\n    <Pagination>\n      {/* <Pagination.Prev /> */}\n      {Items}\n      {/* <Pagination.Item active>1</Pagination.Item>\n      <Pagination.Item>2</Pagination.Item>\n      <Pagination.Item>3</Pagination.Item> */}\n      {/* <Pagination.Next /> */}\n    </Pagination>\n  );\n}\n\nconst SearchBar = props => {\n  return (\n    <Form.Control \n      type=\"text\"\n      name=\"search\"\n      onChange={props.onChange}\n      placeholder={props.placeholder}\n      className=\"mx-1\"\n    />\n  )\n}\n\nconst TableHeaders = ({ headers, actions = false }) => {\n  return (\n    <thead>\n      <tr>\n        { headers.map((header, index) => <th key={index}>{header}</th>) }\n        { actions ?\n          <th>Acciones</th>\n          : null\n        }\n      </tr>\n    </thead>\n  );\n}\n\nconst TableBody = props => {\n  const { data } = props;\n  return (\n    <tbody>\n      { data.length === 0 ?\n        <EmptyRow />\n        : \n        <>\n          { data.map(entry => \n            <Row \n              key={entry.id}\n              entry={entry} \n              actions={props.actions}\n              edit={props.edit} \n              delete={props.delete} \n            />\n          ) }\n        </>\n      }\n    </tbody>\n  );\n}\n\nconst EmptyRow = () => {\n  return (\n    <tr>\n      <td colSpan=\"5\">No hay resultados</td>\n    </tr>\n  )\n}\n\nconst Row = (props) => {\n  const { entry } = props;\n  const properties = entry.properties;\n  const customer = properties.customer;\n  const products = properties.invoicedetails;\n  const formatted = formatInvoices(products);\n\n  const invoices = formatted.map(product => \n    <div key={product.id}>\n      <p><span className=\"text-bold\">Producto:</span> {product.description}</p>\n      <p><span className=\"text-bold\">Agricultor:</span> {product.grower}</p>\n    </div>\n  );\n\n  const handleEdit = () => {\n    props.edit(entry);\n  }\n  const handleDelete = () => {\n    props.delete(entry.id);\n  }\n\n  return (\n    <tr>\n      <td>{entry.id}</td>\n      <td>{customer}</td>\n      <td>\n        { invoices }\n      </td>\n      <td>{moment(entry.created_at).format('MMMM D YYYY, h:mm a')}</td>\n      { props.actions ?\n        <td>\n          <Button \n            title=\"Editar\"\n            size=\"sm\" \n            variant=\"info\" \n            className=\"mr-2\" \n            onClick={handleEdit}>\n            <i className=\"fa fa-pencil\"></i>\n          </Button>\n          <Button \n            title=\"Eliminar\"\n            size=\"sm\" \n            variant=\"danger\" \n            onClick={handleDelete}>\n            <i className=\"fa fa-trash\"></i>\n          </Button>\n        </td>\n        : null\n      }\n    </tr>\n  );\n}\n\nconst formatInvoices = (invoices) => {\n  if (invoices === undefined) return [];\n  let keys = Object.keys(invoices);\n  let formatted = [];\n  keys.map((item) => {\n      formatted.push(invoices[item]);\n      return null;\n  });\n  return formatted;\n}\n\nexport default TableBuilder;"]},"metadata":{},"sourceType":"module"}